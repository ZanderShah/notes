CO 456
=

## Game of Nim

We are given a collection of piles of chips. Two players play alternately. On a player's turn, they remove at least one chip from a pile. The first player who cannot move loses the game.

**Example**.

> **1, 1, 2**. First player takes both chips from the 2-pile, forces a win.
>
> **6, 9**. First player takes 3 from the 9-pile, mimic the moves of the second player to force a win.

If there is a move which forces a win, then the game is a **winning position**. From a **losing position**, any move leads to a winning position for the other player.

**Lemma**: If we have exactly 2 piles, with $n$, $m$ chips, then player I wins if and only if $n \neq m$.

## Impartial Games

### Conditions

1. There are exactly 2 players (player I and II).
2. There are several positions, with a starting position.
3. A player performs one of a set of allowed moves, which depends on only the current position (not on the player whose turn it is). "Impartial" (not chess). Each move generates an **option**.
4. The players move alternately.
5. There is complete information.
6. There are no chance moves.
7. The first player with no available move loses.
8. The rules guarantee that the games ends.

**Example**. $G = (1, 1, 2)$ game in Nim. Four possible moves.

> $$G = (1, 1, 2) \rightarrow \begin{cases}&H_1 = (1, 1, 1) \\ &H_2 = (1, 1, 0) \\ &H_3 = (0, 1, 2) \\\ &H_4 = (1, 0, 2)\end{cases}$$
>
> Impartial games can be recursively defined by its position and options.

**Definition**: A game $H$ that is reachable from $G$ by a sequence of moves is **simpler** than $G$.

**Lemma**: In any game $G$, it is a winning position for player I or player II.

> We proceed by induction on the simplicity of $G$. If $G$ has no allowed moves, then it is a winning position for the player not in their turn. Assume $G$ has allowed moves, assume claim is true for games simpler than $G$. Assume player I is the current player. Consider all options of $G$. If one of them is a winning position for player I, then player I moves to that option, wins that game, then also wins $G$. Otherwise, all options are winning positions for player II. So any move player I makes will make player II win. So $G$ is a winning position for player II.

### Game Sums

**Definition**: Let $G$, $H$ be two games with options $G_1, ..., G_m$, and $H_1, ..., H_n$ respectively. We define $G + H$ as the game with options $G_1 + H, ..., G_m + H, G + H_1, ..., G + H_n$.

**Example**: We denote $\star n$ to be a game of Nim with one pile of $n$ chips. Then $\star 1 + \star 1 + \star 2$ is the game of three piles with $(1, 1, 2)$ chips.

Let $\bf G$ be the set of all impartial games.

1. $G + H \in \bf G$ for any $G, H \in \bf G$ (closure).
2. $(G + H) + J = G + (H + J)$ (associative).
3. There exists $0 \in \bf G$ where $0 + G = G + 0 = G$ for all $G \in \bf G$. 0 is the game with no options.
4. $G + H = H + G$ for all $G, H \in \bf G$ (symmetric).

> **Aside**: These are properties of an abelian group except for the inverse property.

### Game Equivalences

**Definition**: Two games $G, H$ are **equivalent** is if for any game $J$, $G + J$ is a losing game if and only if $H + J$ is a losing game. Adding the same game does not alter the outcome.

**Notation**: $G \equiv H$.

**Example**: $\star 3 \equiv \star 3$. $\star 3 \not\equiv \star 4$ since $\star 3 + \star 3$ is a losing game and $\star 4 + \star 3$ is a winning game. So $\star n \equiv \star m$ if and only if $n = m$.

$\equiv$ is an equivalence relation.

1. Reflexive. $G \equiv G$.
2. Symmetric. $G \equiv H$ if and only if $H \equiv G$.
3. Transitive. If $G \equiv H$ and $H \equiv K$, then $G \equiv K$.

> Quick exercise to verify.

**Exercise**: If $G \equiv H$ then $G + J \equiv H + J$ for any $J$.

**Lemma**: $G$ is a losing game if and only if $G \equiv \star 0$.

> **Note**: Start of proving that every impartial game is equivalent to a some Nim game.
>
> $(\Leftarrow)$ If $G \equiv \star 0$, then $G + \star 0$ is a losing game if and only if $\star 0 + \star 0$ is a losing game. We know $\star 0 + \star 0$ is a losing game.
>
> $(\Rightarrow)$ Suppose that $G$ is a losing game. We want to show $G + J$ is a losing game if and only if $\star 0 + J = J$ is a losing game.
>
> $(\leftarrow)$ Suppose $J$ is a losing game. Use induction on the simplicity of $G + J$. Base case $\equiv$ if left as an exercise. Consider $G + J$. Player I can move in $G$ or in $J$.
>
> 1. Suppose player I moves from $G + J$ to $G + J^\prime$. Since $J$ is a losing game, $J^\prime$ is a winning game. So player II has a winning move from $J^\prime$ to $J^{\prime\prime}$ such that $J^{\prime\prime}$ is a losing game. By induction, $G + J^{\prime\prime}$ is a losing game. So player I loses.
> 2. Similar if we go from $G + J$ to $G^\prime + J$. Player II moves to $G^{\prime\prime} + J$ which is by induction a losing game. So player I loses.
>
> So in both cases, $G + J$ is a losing game.
>
> $(\rightarrow)$ Suppose $G + J$ is a losing game. Suppose by way of contradiction $J$ is a winning game. Then PI has a winning move $J \to J^\prime$. So $J^\prime$ is a losing game. Then by induction, $G + J^\prime$ is a losing game. Then $G + J$ is a winning game, contradiction.

**Corollary**: If $G$ is a losing game, then $J$ has the same outcome as $J + G$.

> Since $G$ is a losing game, $G \equiv \star 0$. Add $J$ to both sides. $G + J \equiv \star 0 + J = J$.

**Example**:

1. Recall that $\star 5 + \star 5$ and $\star 8 + \star 8$ are both losing games. By corollary, $\star 5 + \star 5 + \star 8 + \star 8$ is still a losing game. Player I can either play in $\star 5 + \star 5$ or $\star 8 + \star 8$. Player II will make a winning move in the same part of the game. So we still end up with a losing game.
2. $(\star 1 + \star 1 + \star 2) + (\star 5 + \star 5)$ is a winning game and a losing game. Player I makes winning move in $(\star 1 + \star 1 + \star 2)$. Player II has two losing parts. So we still end up with a losing game.

**Lemma** (Copycat Principle): For any game $G$, $G + G \equiv \star 0$.

> This is true when $G$ has no options. Consider $G + G$ and without loss of generality player I moves to $G^\prime + G$. Then player II can move to $G^\prime + G^\prime$. By induction $G^\prime + G^\prime \equiv \star 0$, so it is a losing game for player I. So $G + G$ is a losing game, so $G + G \equiv \star 0$.
>
> **Aside**: If we treat our games as equivalence classes, then the inverse of a game is itself. Adding $G + G$ gives the identity $\star 0$.

**Lemma**: $G \equiv H$ if and only if $G + H \equiv \star 0$.

> $(\Rightarrow)$ If $G \equiv H$ then $G + G = \star 0 \equiv H + G$.
>
> $(\Leftarrow)$ If $G + H \equiv \star 0$ then $G + G + H \equiv H \equiv \star 0 + G \equiv G$

**Example**: $\star 1 + \star 2 + \star 3 \equiv \star 0$. By Lemma, $\star 1 + \star 2 \equiv \star 3$.

**Lemma**: If the options of $G$ are equivalent to the options of $H$, then $G \equiv H$. (More precisely: there is a bijection between the options of $G$ and $H$, where the paired options are equivalent).

**Example**: We can show $\star 1 + \star 2 \equiv \star 3$ using this lemma.

> $$\star 1 + \star 2 \rightarrow \begin{cases}&\star 2 \\ &\star 1 \\ &\star 1 + \star 1 \equiv \star 0 \end{cases}$$
> $$\star 3 \rightarrow \begin{cases}&\star 2 \\ &\star 1 \\ &\star 0  \end{cases}$$

Converse is not true.

> It suffices to show $G + H \equiv \star 0$, or $G + H$ is a losing game. If $G, H$ have no options, then $G + H \equiv \star 0$. Now WLOG, suppose player I moves to $G^\prime + H$. By assumption, $G^\prime \equiv H^\prime$ for some option $H^\prime$ of $H$. So player II moves to $G^\prime + H^\prime$. By Lemma, $G^\prime + H^\prime \equiv \star 0$, so it is a losing game for player I.

### Nim Sums

**Definition**: If $\star m + \star n \equiv \star k$, then $k$ is the Nim sum of $m, n$.

**Unproven Theorem**: Suppose $n = 2^{a_1} + 2^{a_2} + ...$, where $a_1 > a_2 > ...$. Then $\star n \equiv \star 2^{a_1} + \star 2^{a_2} + ...$.

> Proven below.

**Examples**.

1. $11 = 2^3 + 2^1 + 2^0$. So $\star 11 \equiv \star 8 + \star 2 + \star 1$.
2. $13 = 2^3 + 2^2 + 2^0$. So $\star 13 \equiv \star 8 + \star 4 + \star 1$.
3. $\star 11 + \star 13 \equiv \star 8 + \star 8 + \star 4 + \star 2 + \star 1 + \star 1 \equiv \star 4 + \star 2 \equiv 6$.

> This is an xor operation.

When is $\star b_1 + \star b_2 + ... + \star b_k \equiv \star 0$? When each power of $2^a$ appears in even number of terms.

Given $\star b_1 + \star b_2 + ... + \star b_k \equiv \star c$, where $c > 0$, what is a winning move? We want to make a move so the resulting game is equivalent to $\star 0$. We add $\star c$ to both sides. We only affect one stack, so we can replace a stack $b_i$ with $\star b_i + \star c$. This is only valid if the Nim sum of $b_i$ and $c$ is strictly smaller than $b_i$. This will happen to at least one of $b_1, ..., b_k$.

**Example**: $\star 11 + \star 13 \equiv \star 6$. Add $\star 6$ to $\star 11$ or $\star 13$.

> $\star 13 + \star 6 \equiv \star 11$, so the winning move is removing $2$ from $\star 13$.

**Lemma**: If $\star b_1 + ... + \star b_k \equiv \star s$, where $s \ge 0$, then there exists $i$ where the Nim sum of $b_i$ and $s$ is strictly less than $b_i$.

> Suppose $s = 2^{a_1} + 2^{a_2} + ...$ where $a_1 > a_2 > ...$. An odd number of $b_i$'s contain $2^a_i$, let a specific $b_i$ be one of them. Let $\star t \equiv \star b_i + \star s$. Since $2^{a_1}$ is in both $b_i$ and $t$, they cancel and do not appear in $t$. At worst, $2^{a_2}, 2^{a_3}, ...$ appear in $t$. So $t \le b_i - 2^{a_i} + 2^{a_2} + 2^{a_3} + ... < b_i$.

**Theorem**: Suppose $n = 2^{a_1} + 2^{a_2} + ...$, where $a_1 > a_2 > ...$. Then $\star n \equiv \star 2^{a_1} + \star 2^{a_2} + ...$.

> This theorem uses the following lemma. **Lemma**: Let $0 \le p, q < 2^a$. Suppose our theorem holds for all values less than $2^a$. Then Nim sum of $p$ and $q$ is also strictly less than $2^a$.
>
> **Theorem proof illustration**: We will use induction. Consider $\star 7$. $7 = 4 + 2 + 1$, want to prove $\star 7 \equiv \star 4 + (\star 2 + \star 1)$. We have $\star 7 \equiv \star 4 + \star 3$ by induction, so we need to show $\star 7 \equiv \star 4 + \star 3$. We can show that the two sides have equivalent options.
>
> By induction on $n$. When $n = 1$, $n = 2^0$, and $\star 1 \equiv \star 2^0$. Suppose $n = 2^{a_1} + 2^{a_2} + ...$, where $a_1 > a_2 > ...$. Let $q = n - 2^{a_1}$. When $q = 0$, $\star n \equiv \star 2^{a_1}$. Assume $q \ge 1$. By induction, $\star q \equiv \star 2^{a_2} + \star 2^{a_3} + ...$. It remains to show that $\star n \equiv \star 2^{a_1} + \star q$. We do this by showing the options are equivalent. The options of $\star n$ are $\star (n-1), ..., \star 0$. There are two types of options for $\star 2^{a_1} + \star q$.
>
> - $\star i + \star q$, $0 \le i < 2^{a_i}$. Suppose $\star i + \star q \equiv \star r_i$ for some $r_i$. Since $i < 2^{a_i}$ and $q < 2^{a_i}$, by induction and lemma, $r_i < 2^{a_i}$. If $\star r_i \equiv \star r_j$, then $\star i + \star q \equiv \star j + \star q$, so $\star i \equiv \star j$, so $i = j$. So $r_0, ..., r_{a_1 - 1}$ are all distinct and less than $2^{a_1}$. By pigeonhole-ish, $\{r_0, ..., r_{2^{a_1 - 1}}\} = \{\star 0, ..., \star 2^{a_1 - 1}\}$.
> - $\star 2^{a_1} + \star i$, where $0 \le i < q$. Let $i = 2^{b_1} + 2^{b_2} + ...$, then none of the $b_i$'s is equal to $a_1$. Then $2^{a_1} + 2^{b_1} + ...$ is a sum of distinct powers of $2$. Using induction, $\star 2^{a_i} + \star i \equiv \star 2^{a_1} + \star 2^{b_1} + \star 2^{b_2} + ... \equiv \star(2^{a_1} + i)$. The options of this type are equivalent to $\{\star 2^{a_1}, \star (2^{a_1} + 1), ..., \star(2^{a_1} + q - 1)\}$. Since the two sides have equivalent options, $\star n \equiv \star 2^{a_1} + \star q$.

### Nim Equivalences

We want to show that all impartial games are equivalent to Nim games with 1 pile.

**Example**: $\star 11 + \star 13 \equiv \star 6$.

> Suppose we go to $\star 11 + \star 4 \equiv \star 15$. Similar to adding $9$ chips to $\star 6$. What is the effect of allowing stacks to increase?
>

Consider the game of poker Nim. It consists of a regular Nim game plus a bag of $B$ chips. We not allow regular Nim moves and adding $B^\prime \le B$ chips to one pile. If we face a losing game in Nim, we could add chips instead. But the other player can just take the same chips away, and nothing changed. So poker Nim is essentially the same as Nim.

Suppose a game $G$ with options $\star 0, \star 1, \star 2, \star 5, \star 10, \star 24$. We claim that this is equivalent to $\star 3$. The options of $\star 0, \star 1, \star 2$ are present. If we add chips to $\star 3$, then the second player can remove them back to $\star 3$. We get $3$ as the smallest non-negative integer not in $\{\star 0, \star 1, \star 2, \star 5, \star 10, \star 24\}$. We define $mex(S)$ to be the smallest non-negative integer not in $S$ (minimum excluded integer).

**Theorem**: Let $G$ be an impartial game whose options are equivalent to $\{\star s: s \in S\}$. Then $G \equiv \star mex(S)$.

> Let $m = mex(S)$. It suffices to show that $G + \star m \equiv \star 0$.
>
> Suppose we move to $G + \star m^\prime$ where $m^\prime < m$. Since $m = mex(S)$, $m^\prime \in S$. So there exists an option $G^\prime$ of $G$ equivalent to $\star m^\prime$. Player II moves to $G^\prime + \star m^\prime$ and this is a losing game. So $G + \star m$ is a losing game for player I.
>
> Suppose we move to $G^\prime + \star m$. Then $G^\prime \equiv \star k$ for some $k \in S$. Then $G^\prime + \star m \equiv \star k + \star m \not\equiv \star 0$ since $k \neq mex(S)$. So $G^\prime + \star m$ is a winning game for player II. So $G + \star m$ is a losing game for player I.
>
> If $m = 0$, then all options of $G$ are winning games. So $G \equiv \star 0$, and $G + \star m \equiv \star 0 + \star 0 \equiv \star 0$.

**Corollary**: Any impartial game $G$ is equivalent to some Nim game $\star n$.

> If $G$ has no options then $G \equiv \star 0$. Suppose $G$ has options $G_1, G_2, ..., G_q$. By induction, $G_i \equiv \star n_i$ for some $n_i$, for each $i$. By theorem, $G \equiv \star mex(\{n_1, ..., n_q\})$.

**Example**:

> $$\star 1 + \star 1 + \star 2 \to \begin{cases}\star 1 + \star 2 \equiv \star 3 \\ \star 1 + \star 1 \equiv \star 0 \\ \star 1 + \star 1 + \star 1 \equiv \star 1\end{cases}$$
> By theorem, $\star 1 + \star 1 + \star 2 \equiv \star mex(\{0, 1, 3\}) \equiv \star 2$.

**Exercise**: A game cannot be equivalent to one of its options.

### Finding Nim Values

**Example**: In the rook game, we have an $m \times n$ chess board, and a rook at position $(i, j)$. A move consists of moving the rook any positive number of spaces to the left or up. The player with no move loses.

> $$\begin{bmatrix}
\star 0 & \star 1 & \star 2 & \star 3 \\
\star 1 & \star 0 & \star 1 & \star 2 \\
\star 2 & \star 1 & \star 0 & \star 1 \\
\star 3 & \star 2 & \star 1 & \star 0 \\
\end{bmatrix}$$


The Nim value of $(i, j)$ is $mex(\{(i^\prime, j): 0 \le i^\prime < i - 1\} \cup \{(i, j^\prime): 0 \le j^\prime < j - 1\})$.

**Example**: In the subtraction game, we have one pile of $n$ chips. A move is taking away $1$, $2$, or $3$ chips. Let $S_n$ be the Nim values of the game with $n$ chips. Then $S_n = mex(\{S_{n-1}, S_{n-2}, S_{n-3}\})$.

> | $n$ | $S_n$ |
> | :---: |:---:|
> | $0$ | $0$ |
> | $1$ | $1$ |
> | $2$ | $2$ |
> | $3$ | $3$ |
> | $4$ | $0$ |
> | $5$ | $1$ |
> | $6$ | $2$ |
> | $7$ | $3$ |

Suppose we change valid moves to removing $2$, $5$, or $6$ chips.

> | $n$ | $S_n$ |
> | :---: |:---:|
> | $0$ | $0$ |
> | $1$ | $0$ |
> | $2$ | $1$ |
> | $3$ | $1$ |
> | $4$ | $0$ |
> | $5$ | $2$ |
> | $6$ | $1$ |
> | $7$ | $3$ |
> | $8$ | $0$ |
> | $9$ | $2$ |
> | $10$ | $1$ |
> | $11$ | $0$ |
> | $12$ | $0$ |
> | $13$ | $1$ |
> | $14$ | $1$ |

Losing game if and only if $n = 0, 1, 2, 4, 8 \pmod {11}$.

**Example**: Rook game at $(4, 2)$ $+$ second subtraction game $n = 7$.

> Equivalent to $\star 2 + \star 3 \equiv \star 1$. So it is a winning game. Winning moves are removing $2$ from the subtraction game, and moving left with the rook.

# Strategic Games

**Definition**: Given by specifying a set $N = \{1, ..., n\}$ of players, and for each player $i$, there is a set $S_i$ of strategies and a utility function $u_i: S_1 \times ... \times S_n \to \mathbb{R}$.

**Example**: Two players I, II. Rows are PI strategies, columns are PII strategies. Cells are the utility of PI, PII.

> $$\begin{bmatrix}
5K, 5K & 0, 10K \\
10K, 0 & 1, 1
\end{bmatrix}$$

1. All players are rational and selfish.
2. All players have knowledge of all game parameters.
3. Players move simultaneously.
4. Each player $i$ chooses strategy $i \in S_i$, and this forms a strategy profile $S = (S_1, ..., S_n) \in S_1 \times ... \times S_n$, the outcome of the game. Player $i$ earns utility $u_i(S)$.

# Auctions

- Buyers $N = \{1, ..., n\}$ for a single item. Buyer $i$ values the item at price $v_i$, and submits bid $b_i$. Strategy profile is $(b_1, ..., b_n)$. Ties are broken by index.
- $u_i = \begin{cases}v_i - \max_{j \neq i} b_n,\ &\text{Player $i$ wins} \\ 0,\ &\text{otherwise}\end{cases}$.

**Theorem**: In second-price bid auction, $v_i$ is a dominant strategy for all $i$.

> Consider strategy profile $b \in S$. We first show that $u_i(v_i, b_{-i}) \ge u_i(b)$ for all $b_i \in S$.
> 
> 1. Suppose $v_i$ is the winning bid in $(v_i, b_{-i})$. Let $b_j$ be the second highest bid in $b$. $u_i(v_i, b_{-i}) = v_i - b_i \ge 0$. Let us switch our bid to $b_i$. Suppose $b_i < b_j$, so $b_i$ is still winning, so $u_i(b_i, b_{-i}) = u_i(v_i, b_{-i})$. Suppose $b_i < b_j$, so $b_i$ is a losing bid, $u_i(b_i, b_{-i}) \le 0$.
> 2. Suppose $v_i$ is a losing bid. Suppose $b_i < b_j$, then $b_i$ is a losing bid, $u_i(b_i, b_{-i}) = 0$. Suppose $b_i > b_j$, then $b_i$ is a winning bid, $u_i(b_i, b_{-i}) = v_i - b_j \le 0$.
>
> It remains to show that for every $i$, there exists $b_i \in S_i \setminus \{v_i\}$ such that $u_i(v_i, b_{-i}) > v_i(b_i, b_{-i})$.
>
> 1. Suppose $b_i < v_i$. Let $k \in (b_i, v_i)$. Set $b_j = k$ for $i \neq j$. Then $u_i(v_i, b_{-i}) > 0$, but $u_i(b_i, b_{-i}) = 0$.
> 2. Suppose $b_i > v_i$. Let $k \in (v_i, b_i)$. Set $b_j = k$ for $i \neq j$. Then $u_i(v_i, b_{-i}) = 0$, but $b_i$ is a winning bid, so $u_i(b_i, b_{-i}) < 0$.

# Mixed Strategy Games

- **Mixed Strategy** for player $i$ is $x^i \in \mathbb{R}_{+}^{S_i}$ such that $\sum_{s_i \in S_i} x^i_{s_i} = 1$. A **mixed strategy profile** is $x = (x^1, ..., x^n)$, where $x^i$ is a mixed strategy for player $i$.
- Utility is calculated with expected values. **Expected utility of strategy** $s_i \in S_i$ is $u_i(s_i, x^{-i}) = \sum_{s_i \in S_i} u_i(s_i, s_{-i})\Pi_{j\neq i} x^j_{S_j}$, where $u_i(s_i, s_{-i})$ is the utility from the pure strategy game. **Expected utility** of player $i$ is $u_i(x) = \sum_{s_i \in S_i} x^i_{s_i} u_i(s_i, x^{-i})$.
- Preferences may differ in mixed strategy games depending on the utility.
- Mixed strategy profile is **mixed Nash equilibrium** if for every $i \in N$, $u_i(\overline{x}) \ge u_i(x^i, \overline{x}^{-i})$, for all mixed strategies $x^i$.

**Definition**: **Best response function** $B_i(\overline{x}^{-i})$ for player $i$ is the set of all mixed strategies with maximum expected utility against $\overline{x}^{-i}$.

**Proposition**: $\overline{x} = (\overline{x}^1, ..., \overline{x}^n)$ is a mixed Nash equilbrium if and only if $\overline{x}^i \in B_i(\overline{x}^{-i})$ for all $i \in N$.

Example: Matching pennies.

> Suppose $x^1 = (p, 1 - p)$, $x^2 = (q, 1 - q)$. For player I, expected utility for playing $H$ is $q(1) + (1-q)(-1) = 2q - 1$. Expected utility for player $T$ is $q(-1) + (1-q) = 1 - 2q$. So the overall expected utility is $p(-2 + 4q) + (1 - 2q)$. Given $q$ we find $p$ that gives maximum $u_i(x^2)$. $q$ is constant, so $1 - 2q$ is constant. Suppose $q < \frac{1}{2}$, maximized when $p = 0$. Suppose $q = \frac{1}{2}$, any value of $p$ gives the same utility. Suppose $q > \frac{1}{2}$, maximized when $p = 1$. So $B_1(x^2) = \begin{cases}[0],\ &q < \frac{1}{2}\\ [0, 1],\ &q = \frac{1}{2}\\ [1],\ &q > \frac{1}{2}\end{cases}$.

## Support Characterization

Let us maximize utility for player $i$ given $\overline{x}^{-i}$.

$$\begin{aligned}
\max\ &\sum_{s \in S_i} x^i_s u_i(s, \overline{x}^{-i}) \\
\text{s.t. } &\sum_{s \in S_i} x^i_s = 1\\ &x^i \ge 0
\end{aligned}$$

This is a LP with $x^i$ as the variables. Let us take the dial.

$$\begin{aligned}
\min\ &y \\
\text{s.t. } &y \ge u_i(s, \overline{x}^{-i}),\ \forall s \in S_i
\end{aligned}$$

$(P)$ is feasible, $(D)$ is feasible, so they have an optimal solution by the fundamental theorem of LP. By strong duality theorem, their optimal solutions have the same objective value. The value of $y$ minimizing $(D)$ is $\max_{s \in S_i} u_i(s, \overline{x}^{-i})$. We reconstruct the optimal value of $(P)$.

**Recal**: Complementary slackness conditions. For every $s \in S_i$, either $x^i_s = 0$ or $y = u_i(s, \overline{x}^{-i})$. So if $x^i_s > 0$, then $y = u_i(s, \overline{x}^{-i})$, meaning only pure strategies with the highest expected utility could have non-zero probabilities in the best repsonse.

**Recall**: Feasible solutions $(\overline{x}^i, y)$ are optimal if and only if they satisfy the complementary slackness conditions.

**Theorem**: Given $\overline{x}^{-i}$, mixed strategy $x^i \in B_i(\overline{x}^{-i})$ if and only if $\overline{x}^i_s > 0$ implies $s \in S_i$ is a pure strategy of maximum expected utility against $\overline{x}^{-i}$.

*Note*: By strong duality, the overall expected mixed strategy utility is equal to the maximum utility when playing a pure strategy. Any probability distribution over all strategies with maximum expected utility is a best response.

## 2-Player Zero-Sum Games

> **Theorem**: Every finite strategy game has a mixed Nash equilibrium.

We focus on 2-player zero-sum games. A strategic game is **zero-sum** if $\sum_{i \in N} u_i(s) = 0$ for every strategy profile $s$. For 2-player games, we can define this game using a single payoff matrix $A \in \mathbb{R}^{m \times n}$, where $u_1(i, j) = A_{i, j}$, $u_2(i, j) = -A_{i, j}$.

Suppose player I players $x^1$. They expected player II to use a strategy from their best response. Player II's expected utility when playing $j$ is $(-x^1)^TA_{.,j}$, where $A_{.,j}$ is the $j$th column of $A$. Player II looks for $\max_{j^\prime} -(x^1)^T A_{.,j^\prime} = -\min_{j^\prime} (x^1)^T A_{.,j^\prime}$. This is also the overall expected utility. Since this a zero-sum game, the expected utility for player I is $\min_{j^\prime} (x^1)^T A_{.,j^\prime}$. Player I wants to maximize this value.

$$\begin{aligned}
\max\ &y\\
\text{s.t. } &y \le (x^1)^T A_{.,j^\prime}\ &\forall j^\prime \in \{1, ..., m\} \\
&\sum_{i=1}^m x^1_i = 1 \\
&x^1 \ge 0
\end{aligned}$$

For player II, we have a similar LP.

$$\begin{aligned}
\min\ &y\\
\text{s.t. } &(x^2)^T A_{i^\prime, .} \le y\ &\forall i^\prime \in \{1, ..., n\} \\
&\sum_{j=1}^n x^2_j = 1 \\
&x^2 \ge 0
\end{aligned}$$

These LP are duals of each other, where both are feasible, so they have optimal solutions with equal value. The optimal solutions are best responses to each other, so they are a mixed Nash equilibrium.

**Theorem**: Any 2-player zero-sum game has a mixed Nash equilibrium which can be efficiently computed.

## Voting Game.

Suppose there are two candiates $A, B$, with $a, b$ supporters respectively. Without loss of generality, assume $a \ge b$. Voters gain utility 2 if the supporting candidate wins, 1 if they tie, 0 if they lose. Voters either abstain or vote with cost $c$. Assume $c \in (0, 1)$.

Example: $a = b$.

> 1. Everyone votes, $1 - c$ utility for all. Abstaining changes utility to $0$, Nash equilibrium.
> 2. Not everyone votes but there is a tie. A voter who abstains will vote, changing utility from $1$ to $2 - c$. Not a Nash equilibrium.
> 3. Candidate wins by $1$ vote. A voter who abstains will vote, changing utility from $0$ to $1 - c$. Not a Nash equlibrium.
> 4. Candidate wins by $\ge 2$ votes. A voter who voted will abstain, changing utility from $2 - c$ to $2$. Not a Nash equlibrium.
>
> So in a close election, more people vote.

Example: Possible Mixed Nash equilibrium.

> Suppose $b$ of the supporters of $A$ vote. Suppose all supporters of $B$ vote with probability $p$. The best that $B$ can do is a tie.
>
> Consider a supporter of $B$. if they abstain, $B$ loses with expected utility $0$. Voting has expected utility $p^{b-1}(1-c) + (1 - p^{b-1})(-c) = p^{b-1} - c$. In a mixed Nash equilibirum, $0 = p^{b-1} - c$, so $p = c^{\frac{1}{b-1}}$.

# Sperner's Lemma

Finite set of vectors $x^0, ..., x^n$ are *affinely independent* if for $\lambda_0, ..., \lambda_n \in \mathbb{R}$, $\sum_{i=0}^n \lambda_i x^i = 0$ and $\mathbb{1}^T \lambda = 0$ implies $\lambda_0 = ... = \lambda_n = 0$.

*Note*: This is the case if and only if $x_0 - x_1, ..., x_0 - x_n$ are *linearly independent*.

When $x_0, ..., x_n$ are *affinely independent* points, we call $conv(\{x_0, ..., x_n\})$ an $n$-simplex. Let $e^i$ be the $i$th $n$-dimensional unit vector. We call the $n$-simplex $conv(\{e^0, ..., e^n\})$ the **standard $n$-simplex**.

**Definition**: Simplical subdivision of an $n$-simplex $T$ is a finite collection $T_1, ..., T_q$ of simplices such that $\cup_{i=1}^q T_i = T$, and any two distict simplices either do not intersect, or intersect at a common face.

Given an $n$-simplex $T$ and a simplical sub-division $S$, let $V$ be the set of all extreme points. Then every $v \in V$ lies in $T$, so it is representable as an convex combination of it's extreme points. Let $x(v) = \{i \in \{0, ..., n\} \mid \lambda_i > 0\}$ be the index set of vertices of $T$ needed in $v$'s convex combination.

## Labelling

We say that a function $L: V \to \{0, ..., n\}$ is a **proper labelling** of $V$ if $L(v) \in x(v)$ for all $v \in V$. When $L$ assumes all $n + 1$ values of the vertices of $T$, then $T$ is **completely labelled** by $L$.

> Proof by induction on $n$. When $n = 0$, the statement is vacuously true. When $n > 0$, let us drop $x^n$ of $T = conv(\{x^0, ..., x^n\})$ and consider $T^\prime = conv(\{x^0, ..., x^{n-1}\})$. This is a $n-1$-simplex, so $S^\prime = \{T_i \cap T^\prime \mid T_i \in S\}$ is a simplical subdivision of $T^\prime$. $V^\prime$ of $S^\prime$ are a subset of the vertices $V$ of $S$, so a proper labelling of $L$ for $V$ is a proper labelling $L^\prime$ of $V^\prime$. So $S^\prime$ has an odd number of completely labelled simplices by the hypothesis.
>
> Assume that $S$ comsists of $n$-simplices. Let $F_i$ represent these simplices, with $F_i = conv(\{v_j \mid i \neq j\})$ for $i \in \{0, ..., n\}$. Let $\mathbb{F}$ represent the set of facets of simplices in $S$, let $\mathbb{F}_n$ be those facets whose $n$ vertices have labels $0, ..., n - 1$. We create a graph $G_n$ which has a vertex for every $f \in F_n$, and an edge $ff^\prime$ if $f, f^\prime \in F_n$ are facets of a common simplex in $S$.
>
> We see that a simplex $S$ has a facet $f \in F_n$ has at most one $f^\prime \in F_n$. So the maximum vertex degree is $2$. Recall that we know $S^\prime$ of $T^\prime$ has an odd number of fully labelled sub-simplices, $f_1, ..., f_{2p + 1} \in F_n$. These have degree $1$ in $G_n$, so they must be the endpoint of a path in this graph. Let us partiton the paths $P = P_1 \cup P_2$ such that $P_1$ is the set of paths with both ending in $\{f_1, ..., f_{2p+1}\}$. Then $2p + 1 = 2|P_1| + |P_2|$, so it must be the case that $|P_2|$ is odd. Consider a path $p \in P_2$, let $f^\prime$ be the endpoint whose corresponding facet does not lie on $T^\prime$. Then the labels of $f^\prime$ are in $\{0, ..., n-1\}$, so $f^\prime$ cannot be part of a facet of $T$ other than $T^\prime$. So $f^\prime$ is a facet of a fully labelled simplex in $S$. So there are an odd number of fully labelled simplices in $S$ that correspond to paths in $P_2$.
>
> There may be paths $P_3$ which do not end in $\{f_1, ..., f_{2p + 1}\}$. This path must start and end in a distinct fully labelled simplex of $S$. So the number $2|P_3|$ of such fully labelled simplices is even. $G_n$ may also have cycles $C$, which do not touch fully labelled simplices of $S$.
>
> Since every fully labelled simpliex $S$ has exactly one of its facets in $F_n$, every such simplex must correspond to the endpoint of a path in $P_2 \cup P_3$. So the number of fully labbelled simplices in $S$ is $|P_2| + 2|P_3|$, so odd.

# Brouwer's Fixed Point Theorem

Continuous function $f: \Delta_m \to \Delta_m$ has a fixed point $z \in \Delta_m$ such that $f(z) = z$.

# Nash's Theorem

Every finite strategic game has a mixed Nash equilibirum.

> Given a mixed strategy profile $x \in \Phi_{i \in N} \Delta_{|S_i| - 1} \to \Phi_{i \in N} \Delta_{|S_i| - 1}$, we define $\Phi^i_{s_i}(x) = \max\{0, u_i(s_i, x^{-i}) - u_i(x)\}$. So $\Phi^i_{s_i}(x)$ is positive if and only if $x^i$ is the best response to $x^{-i}$.

We define $f(x) = \overline{x}$ where $\overline{x} = \frac{x^i_{s_i} + \Phi^i_{s_i}(x)}{\sum_{s_i \in S_i}(x^i_{s_i} + \Phi^i_{s_i}(x))} = \frac{x^i_{s_i} + \Phi^i_{s_i}(x)}{1 + \sum_{s_i \in S_i} \Phi^i_{s_i}(x)}$.

Note that $f$ is continuous since $\Phi^i_{s_i}$ are continuous. So $f$ has a fixed point $\hat{x}$. Consider a player $i \in N$ and let $s_i \in S_i$ be a pure strategy such that $\hat{x}^i_{s_i} > 0$ and $u_i(s_i, \hat{x}^{-i}) \le u_i(\hat{x})$. It follows that $\Phi^i_{s_i}(x) = 0$, so it must be the case that $\Phi^i_{s^\prime_i} = 0$ for all $i, s^\prime_i$. So $\hat{x}^i$ is a best response to $\hat{x}^{-i}$ for all $i \in N$, so it is a mixed Nash equilibrium.
