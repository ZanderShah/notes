CO351
=

# Introduction

**Network Flow Theory**: Class of optimization problems on graphs (directed graphs), usually involving the movement of stuff.

Example: Transshipment problem.

> Directed graph. Nodes weights are the supply or demand, arc weights are the cost to move one good across the arc. We want to move all goods from supply to demand while minimizing total cost.
>
> Solutions are representing using another digraph with arcs representing the amount of goods transfered between nodes.

# Graphs

## Definitions

- $G = (V, E)$ consists of a set of **vertices** $V$ and unordered pairs of vertices $E$.
- **Degree** of a vertex $v$ is the number of edges incident to $v$, $d_G(v)$ or $d(v)$.
- **Walk** is sequence of vertices $v_1, ..., v_k$ where $v_i v_{i+1}$ are edges.
- **Path** is a walk with distinct vertices.
- **Cycle** is a walk $v_1, ..., v_k, v_1$, where $v_1, ..., v_k$ are distinct and $k \ge 3$.

## Connectivity and cuts

- $G$ is **connected** if there is a path between every pair of vertices, **disconnected** otherwise.
- For $S \subseteq V$, the **cut** induced by $S$ is the set of all edges with exactly one edge in $S$.
- If $s, t \in V$, $s \in S$, $v \not\in S$, then $\delta(S)$ is an **s,t-cut**.
- There exists an s,t-path if and only if every s,t-cut is non-empty.

**Trees**.

- Connected graph with no cycles. $n$ vertices with $n - 1$ edges.
- **Spanning tree** of $G$ is a subgraph that is a tree which uses all vertices of $G$.
- $G$ has a spanning tree if and only if $G$ is connected.
- If $T$ is a tree and $u, v$ are not adjacent, $T + uv$ contains exactly only cycle $C$. If $xy$ is an edge of $C$ then $T + uv - xy$ is another tree.

# Directed Graphs

## Definitions

- **Directed graphs** (digraph) $D = (N, A)$ is a set of nodes $N$ and a set of arcs $A$ that are **ordered** pairs of nods.
- For an arc $uv$, $u$ is the tail, $v$ is the head.
- **Out-degree** of $v$ is the number of arcs whose tail is $v$, $d(v)$.
- **In-degree** of $v$ is the number of arcs whose head is $v$, $d(\overline{v})$.
- **Directed walk** (diwalk) is a sequence of nodes $v_1, ..., v_k$ such that $v_i v_{i+1}$ arr arcs.
- **Directed path** (dipath) is a diwalk where all nodes are distinct.
- **Directed cycle** (dicycle) is a diwalk $v_1, ..., v_k, v_1$ where $v_1, ..., v_k$ are distinct and $k \ge 3$.

## Cuts

> For $S \subseteq N$, the **cut** induced by $S$ is the set of all arcs whose tails are in $S$ and heads are not in $S$. $\delta(S) = \{uv \in A: u \in S, v \not\in S\}$. $\delta(\overline{S}) = \{uv \in A, u \not\in S, v \in S\}$.

- If $s, t \in N$, where $s \in S$ and $t \not\in S$, then $\delta(S)$ is an **s,t-cut**.

**Proposition**: There exists an s,t-dipath if and only if every s,t-cut is non-empty.

> $(\Rightarrow)$ Let $s = v_1,v_2,...,v_k=t$ be a s,t-dipath. Let $\delta(S)$ be an s,t-cut. Since $v_1 \in S, v_k \not\in S$, there exists a largest index $i < k$ such that $v_i \in S$, $v_{i+1} \not\in S$. So $v_i v_{i+1} \in \delta(S)$, so $\delta(S)$ is non-empty.
>
> $(\Leftarrow)$ Assume every s,t-cut is non-empty. Let $S$ be the set of all nodes $v$ such that an s,v-dipath exists. If $t \in S$, then an s,t-dipath exists, and we are done. If $t \not\in S$, then $\delta(S) \neq \emptyset$, so there must exist some arc $uv \in \delta(S)$. Since $u \in S$, there exists a u,v-dipath $P$. Then $P + uv$ is an s,v-dipath so $v \in S$, contradiction.

## Underlying Graph

> Remove the directions on the arcs to get edges.

- Digraph is **connected** if its underlying graph is connected. *Note: Might not have a dipath between certain ordered pairs of nodes*.
- **Spanning tree** is a spanning tree of the underlying graph.
- **Cycle** is a cycle in the underlying graph. *Note: Not necessarily a directed cycle*.
    - When considering the direction of a cycle in the underlying graph, arcs that go along the direction are **forward arcs**, arcs ones that go against are **backward arcs**.

# Transshipment Problem (TP)

1. Digraph $D = (N, A)$.
2. Node demands $b_v$ for each $v \in N$. Negative demand corresponds to supply.
3. Arc costs $w_e$ for each $e \in A$.

> A solution is called a **flow**. The goal is to minimize the total cost of the flow.

## LP Formulation

> *Notation*: If $x \in \mathbb{R}^T$ and $S \subseteq T$, then $x(S) = \sum_{i \in S}x_i$.

1. **Variables**. For each arc $e \in A$, define $x_e \in \mathbb{R}$.
2. **Objective function**. Cost of transporting $x_e$ on arc $e$ is $w_e x_e$. Want to minimize total costs. $\min w^T x$.
3. **Constraint**. Inflow minus outgoing flow equals the demand. $\delta(u) - \delta(\overline{u}) = b_u$. All variables are non-negative, $x_e \ge 0$.

$$\begin{aligned}
\min\ &w^Tx \\
\text{s.t } &x(\delta(\overline{v})) - x(\delta(v)) = b_v,\ \forall v \in N \\
&x \ge 0
\end{aligned}$$

Matrix form is called an **incidence matrix** where the rows represent nodes and the columns represent arcs.